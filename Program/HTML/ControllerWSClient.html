<!DOCTYPE HTML>
<html>
   <head>
      
      <script type = "text/javascript">
		function handleStart(evt)
		{
			var touches = evt.changedTouches;
			var el = document.getElementsByTagName("canvas")[0];
			
			var acc = -(touches[0].pageY - el.height / 2.0) / el.height * 2;
			var steer = (touches[0].pageX - el.width / 2.0) / el.width * 2;
			
			SendCommand('A', acc.toFixed(2));
			SendCommand('S', steer.toFixed(2));
		}
		function handleMove(evt)
		{
			var touches = evt.changedTouches;
			var el = document.getElementsByTagName("canvas")[0];
			
			var acc = -(touches[0].pageY - el.height / 2.0) / el.height * 2;
			var steer = (touches[0].pageX - el.width / 2.0) / el.width * 2;
			
			SendCommand('A', acc.toFixed(2));
			SendCommand('S', steer.toFixed(2));
			
			evt.preventDefault();
		}
function startup() {
  var el = document.getElementsByTagName("canvas")[0];
  el.addEventListener("touchstart", handleStart, false);
  //el.addEventListener("touchend", handleEnd, false);
  //el.addEventListener("touchcancel", handleCancel, false);
  el.addEventListener("touchmove", handleMove, false);
  // Get the canvas element form the page

 
/* Rresize the canvas to occupy the full page, 
   by getting the widow width and height and setting it to canvas*/
 
el.width  = window.innerWidth;
el.height = window.innerHeight - 100;
 
  console.log("initialized.");
}
		function draw()
		{
			alert("aaa");
			var canvas = document.getElementById('mycanvas');
 
			if(canvas.getContext)
			{
				var ctx = canvas.getContext("2d");
				ctx.fillRect (event.touches[0].pageX, event.touches[0].pageY, 5, 5);
			}
		}
	  
		 var ws = null;
		 
		 function SendWSMessage(msgToSend)
		 {
			ws.send(msgToSend);
		 }
		 
         function SendCommand(cmd, param)
		 {
            var toSend = cmd.concat(param);
			console.log(toSend);
            if ("WebSocket" in window)
			{
				// Let us open a web socket
			    if(ws == null)
			    {
					ws = new WebSocket("ws://192.168.4.1:81");
				
					ws.onopen = function()
					{
					};
					
					ws.onmessage = function (evt)
					{
						var received_msg = evt.data;
					};
					
					ws.onclose = function()
					{ 
						alert("Connection is closed..."); 
					};
				}
				ws.send(toSend);
            }
			else
			{
               alert("WebSocket NOT supported by your Browser!");
            }
         }
      </script>
		
   </head>
   
   <body>
		<div id = "sse">
			<a href = "javascript:SendCommand('F', '50')">--------------</a>
		</div>
<canvas id="canvas" style="border:solid black 1px;">
  Your browser does not support canvas element.
</canvas>
<br>
<button onclick="startup()">Initialize</button>
<br>
Log: <pre id="log" style="border: 1px solid #ccc;"></pre>
  </body>
   </body>
</html>